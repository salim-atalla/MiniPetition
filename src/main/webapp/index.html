<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Petition App</title>
        <style>
            /* Add your styles here if needed */
        </style>
        <script src="https://unpkg.com/mithril/mithril.js"></script>
    </head>
    <body>
        <div id="app"></div>

        <script>
            // Your Mithril.js components and pages
            const PetitionList = {
                petitions: [],

                oninit: function (vnode) {
                    // Fetch petition data and store it in component state
                    m.request({
                        method: "GET",
                        url: "/_ah/api/petitionApi/v1/petitions", // Update the URL based on your API endpoint
                    })
                        .then((response) => {
                            PetitionList.petitions = response;
                            m.redraw(); // Trigger a redraw to update the view
                        })
                        .catch((error) => {
                            console.error(
                                "Error fetching petition data:",
                                error
                            );
                        });
                },

                view: function (vnode) {
                    return m("div", [
                        m("h1", "Petition List"),
                        m(
                            "ul",
                            PetitionList.petitions.map((petition) =>
                                m("li", { key: petition.id }, [
                                    m("h3", petition.title),
                                    m("p", petition.content),
                                    m(
                                        "p",
                                        "Signatures: " +
                                            petition.signatures.length
                                    ),
                                ])
                            )
                        ),
                    ]);
                },
            };

            const Home = {
                view: function (vnode) {
                    return m("div", [m("h1", "Home Page"), m(PetitionList)]);
                },
            };

            // Define Mithril routes and components
            m.route(document.getElementById("app"), "/home", {
                "/home": Home,
                // Add more routes as needed
            });
        </script>
    </body>
</html>
